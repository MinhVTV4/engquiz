body { font-family: 'Be Vietnam Pro', sans-serif; }
.view { display: none; }
.view.active { display: block; animation: fadeIn 0.5s ease-in-out; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.spinner { border: 4px solid rgba(0, 0, 0, 0.1); width: 36px; height: 36px; border-radius: 50%; border-left-color: #0ea5e9; animation: spin 1s ease-in-out infinite; }
.btn-spinner { width: 20px; height: 20px; border-width: 3px; border-left-color: white; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

/* CẬP NHẬT: Thêm #conversationLog và #conversationPracticeLog vào danh sách các container có thể cuộn */
#passageText, #transcriptContainer, #deckList, #deckWordList, #historyList, #reviewList, #libraryList, #writingFeedbackContainer, #reinforceContent, #learningPathContainer, #reinforcementReviewList, #conversationLog, #conversationPracticeLog { max-height: 60vh; overflow-y: auto; }
.topic-container, .vocab-mode-container, #customTopicContainer { transition: all 0.3s ease-in-out; overflow: hidden; }

/* --- Cải tiến UI/UX --- */
@keyframes jiggle { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
@keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-6px); } 75% { transform: translateX(6px); } }

.option-btn.correct { animation: jiggle 0.4s ease-in-out; }
.option-btn.incorrect { animation: shake 0.4s ease-in-out; }

.modal-overlay {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex; align-items: center; justify-content: center;
    z-index: 50;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s, visibility 0.3s;
}
.modal-overlay.active { opacity: 1; visibility: visible; }
.modal-content {
    background-color: white; padding: 2rem; border-radius: 1.25rem;
    max-width: 90%; width: 600px; box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    position: relative; transform: scale(0.95) translateY(10px); opacity: 0;
    transition: transform 0.3s ease-out, opacity 0.3s ease-out;
}
.modal-overlay.active .modal-content { transform: scale(1) translateY(0); opacity: 1; }

.translate-icon { cursor: pointer; color: #3b82f6; margin-left: 8px; font-size: 1.25rem; display: inline-block; vertical-align: middle; }
.highlight-word { background-color: #facc15; color: #1f2937; padding: 2px 0; border-radius: 3px; }

/* --- Word Lookup Styles --- */
.lookup-word { cursor: pointer; }
.lookup-word:hover { background-color: #e0f2fe; }
.saved-word-highlight { border-bottom: 2px dotted #22c55e; cursor: help; }
.saved-word-highlight:hover { background-color: #dcfce7; }
.speak-btn { background: none; border: none; cursor: pointer; }


/* Flashcard Styles */
.flashcard-container { perspective: 1000px; }
.flashcard { width: 100%; min-height: 250px; position: relative; transform-style: preserve-3d; transition: transform 0.6s; cursor: pointer; }
.flashcard.flipped { transform: rotateY(180deg); }
.flashcard-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 20px; border-radius: 1rem; border: 2px solid; }
.flashcard-front { background-color: #e0f2fe; border-color: #7dd3fc; color: #075985; }
.flashcard-back { background-color: #f0fdf4; border-color: #86efac; color: #15803d; transform: rotateY(180deg); }

/* Writing View Styles */
#writingFeedbackContainer del { background-color: #fee2e2; text-decoration: line-through; color: #991b1b; padding: 2px; border-radius: 3px; }
#writingFeedbackContainer ins { background-color: #dcfce7; text-decoration: none; color: #166534; padding: 2px; border-radius: 3px; }

/* Styles for Marked.js output */
.prose p { margin-bottom: 0.75rem; }
.prose ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 0.75rem; }
.prose li { margin-bottom: 0.25rem; }
.prose strong { font-weight: 600; }

/* --- Conversation UI Styles --- */
@keyframes mic-pulse {
    0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
    70% { box-shadow: 0 0 0 20px rgba(239, 68, 68, 0); }
    100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
}
.mic-recording { 
    animation: mic-pulse 1.5s infinite; 
    background-color: #f87171 !important; /* bg-red-400 */
    color: white !important;
}

/* CẬP NHẬT: Hiệu ứng cho chỉ báo "AI đang gõ" */
.typing-dot {
    width: 8px;
    height: 8px;
    background-color: #94a3b8; /* slate-400 */
    border-radius: 50%;
    animation: typing-bounce 1.4s infinite ease-in-out both;
}
.typing-dot:nth-child(1) {
    animation-delay: -0.32s;
}
.typing-dot:nth-child(2) {
    animation-delay: -0.16s;
}
@keyframes typing-bounce {
    0%, 80%, 100% {
        transform: scale(0);
    } 40% {
        transform: scale(1.0);
    }
}

/* CẬP NHẬT: Style cho nút nghe lại trong tin nhắn */
.speak-message-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.25rem; /* p-1 */
    border-radius: 9999px; /* rounded-full */
    color: #94a3b8; /* slate-400 */
    transition: background-color 0.2s, color 0.2s;
    flex-shrink: 0; /* Ngăn nút bị co lại */
}
.speak-message-btn:hover {
    background-color: #e2e8f0; /* slate-200 */
    color: #38bdf8; /* sky-400 */
}
